
## Pipeline of data analysis

### Input files: 
- VCF file of genotype
- annotation file generated from software [ANNOVAR](http://annovar.openbioinformatics.org/en/latest/)
- Z-score file generated by ImpG software
- Phenotype file

### Pipeline 
If the VCF file is from Michigan Imputation Server, please follow [here](https://github.com/WenjianBI/Bioinformatics) to filter SNPs with R2<0.3 and MAF<0.05, and annotate SNPs by the genome regions.

- Step 1: RUN vcf2R.sh:
```
cd /home/wbi1/one_sided_SKAT/Update_NFBC66_2018_07_10
vcf_file=chr21.maf.0.05.R2.0.3.dose.vcf
anno_file=chr21.maf.0.05.R2.0.3.dose.anno.hg19_multianno.txt
output_dir=Results
output_prefix=chr21.maf.0.05.R2.0.3.dose
./vcf2map.sh $vcf_file $anno_file $output_dir $output_prefix
```
- Step 2: RUN map2final.R:
```
options(stringsAsFactors = F)
library(RvED)
source("map2final.R")
output_dir="Y:/one_sided_SKAT/Update_NFBC66_2018_07_10/Results"
output_prefix="chr21.maf.0.05.R2.0.3.dose"
z <- read.csv("Y:/one_sided_SKAT/summary-statistics-ImpG/output/chr21/all.impz", sep="")
Phen.all <- read.csv("Y:/one_sided_SKAT/Update_NFBC66_2018_07_10/pheno1.csv")
pheno=Phen.all[,c("SUBJID","FS_KOL_H","FS_KOL_L","FS_TRIGL")]
covar=Phen.all[,c("SUBJID","SEX")]
colnames(pheno)[1]=colnames(covar)[1]="IID"
colnames(covar)[2]="GENDER"   # colnames of covar/phenotype cannot conflict with raw data, so we change "SEX" to "GENDER"

map2final(output_dir,output_prefix,z,pheno,covar)
```
